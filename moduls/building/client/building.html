<template name="item_building">
  <div class="header">
    <div class="level">
      {{#if building.getCurrentLevel}}
        <span>{{building.getCurrentLevel}}</span> уровень 
      {{else}}
        Не построено
      {{/if}}
    </div>
    <div class="name">
      {{building.title}}
    </div>
    <!-- quest link here -->
    <button 
      class="
        toggle_description 
        {{#if not options.hideDescription}}active{{/if}}
      "
    ></button>
    <a href="{{backToGroupLink}}" class="close"></a>
  </div>

  {{#if submenu}}
    {{>yield region="item_submenu"}}
  {{else}}
    <div 
      class="description" 
      style="{{#if options.hideDescription}}display: none;{{/if}}">
      <div class="scrollbar-inner">{{building.description}}</div>
    </div>

    <div class="item_info">
      <div class="effects">
        {{> item_effect item=building nextLevel=toLevel.get}}
      </div>

      <div class="bottom">
        {{#if gt building.maxLevel building.getCurrentLevel}}
          {{> item_price price=(building.getPrice toLevel.get)}}
        {{/if}}

        <div class="actions">
          {{#if gt building.maxLevel building.getCurrentLevel}}
            <div class="action">
              <button 
                class="max" 
                {{notPremiumDisabled}}
                data-tooltip="Ввести максимум"
                data-tooltip-direction="s"
                {{premiumTitle}}
              ></button>
              {{> InputNumber args
                value=toLevel
                min=(sum building.getCurrentLevel 1)
                max=building.maxLevel
                isShowZero=false
                placeholder="Уровень"
                class="count"
              }}
              <button class="main_action build" disabled="{{not (building.canBuild toLevel.get)}}">Отдать приказ</button>
            </div>
          {{/if}}
          <div class="action">
            {{#if eq building.engName 'Metal'}}
                <progress class="bonus metals {{#with multiply income.metals 0.25}}{{#if gt resources.metals.bonus this}}active{{/if}}{{/with}}" max="{{multiply income.metals bonusStorage}}" value="{{or resources.metals.bonus '0'}}"></progress>
                <button class="additional_action metal" disabled="{{lt building.getCurrentLevel 1}}">Собрать</button>
            {{/if}}

            {{#if eq building.engName 'Crystal'}}
                <progress class="bonus crystals {{#with multiply income.crystals 0.25}}{{#if gt resources.crystals.bonus this}}active{{/if}}{{/with}}" max="{{multiply income.crystals bonusStorage}}" value="{{or resources.crystals.bonus '0'}}"></progress>
                <button class="additional_action crystal" disabled="{{lt building.getCurrentLevel 1}}">Собрать</button>
            {{/if}}

            {{#if eq building.engName 'TradingPort'}}
              <button class="additional_action market" disabled="{{lt building.getCurrentLevel 1}}">Торговать</button>
            {{/if}}

            {{#if eq building.engName 'SpacePort'}}
              <button class="additional_action containers" disabled="{{lt building.getCurrentLevel 1}}">Контейнер</button>
            {{/if}}

            {{#if eq building.engName 'Colosseum'}}
              <a
                class="additional_action tournament {{#if lt building.getCurrentLevel 1}}disabled{{/if}}"
                href="{{pathFor 'building' group='Residential' item='Colosseum' menu='tournaments'}}"
              >
                Турнир
              </a>
            {{/if}}

            {{#if eq building.engName 'PulseCatcher'}}
              <a
                class="additional_action PulseCatcher {{#if lt building.getCurrentLevel 1}}disabled{{/if}}"
                href="{{pathFor 'building' group='Residential' item='PulseCatcher' menu='bonus'}}"
              >
                Бонус
              </a>
            {{/if}}
          </div>
        </div>
      </div> 
    </div>
    {{> item_requirements requirements=getRequirements}}
  {{/if}}
</template>