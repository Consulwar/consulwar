<template name="item_requirements">
	{{#if requirements}}
	<div class="requirements">
		<span class="title">Необходимые технологии:</span>
		{{#each requirements}}
		<a class="{{this.[0].engName}}-icon {{#if this.[0].has this.[1]}}has{{/if}}" href="{{this.[0].url}}">
			{{#if gt this.[1] 1}}{{this.[1]}} уровень{{/if}}
			<div class="{{this.[0].type}}">{{this.[0].name}}</div>
		</a>
		{{/each}}
	</div>
	{{/if}}
</template>

<template name="item_effect">
	{{#if item.effect}}
			<div class="currentLevel">
				{{#if item.maxLevel}}
					{{#with item.effect.[0]}}
						Текущий уровень: {{level}} {{#if eq item.maxLevel level}}(Максимальный){{/if}}<br/>
					{{/with}}
				{{/if}}
				{{#each item.effect}}
					{{#if result}}
						{{name}}{{pretext}}{{formatNumber result}}{{aftertext}}<br/>
					{{/if}}
				{{/each}}
			</div>

			{{#if and item.maxLevel (not (eq item.maxLevel item.effect.[0].level))}}
				<div class="nextLevel">
					{{#with item.effect.[0].next}}
						Следующий уровень: {{level}} {{#if eq item.maxLevel level}}(Максимальный){{/if}}<br/>
					{{/with}}
					{{#each item.effect}}
						{{#with this.next}}
							{{#if and result (not (eq ../result result))}}
								{{name}}{{pretext}}{{formatNumber result}}{{aftertext}}<br/>
							{{/if}}
						{{/with}}
					{{/each}}
				</div>
			{{/if}}
	{{/if}}
</template>

<template name="item_characteristic">
	{{#if item.characteristics}}
		<div class="characteristics">
			{{#if item.targets}}
				Приоритеты атаки:
				<ol class="targets">
					{{#each item.targets}}
						<li><a href="{{this.url}}">{{this.name}}</a></li>
					{{/each}}
				</ol>
			{{/if}}
			{{#each item.triggers.battle}}
			{{this.name}}
			{{/each}}

			{{#if eq item.characteristics.special 'air'}}
				*Воздушная единица<br/>
			{{/if}}

			{{#each item.characteristics.notAttack}}
			{{#if eq this 'air'}}
				*Не атакует воздушные цели
			{{/if}}
			{{/each}}
			
			{{#if item.characteristics.damage}}
				<span class="damage" {{militaryTooltip item.characteristics 'damage'}}>
					{{formatNumberWithISO item.characteristics.damage.min}} —
					{{formatNumberWithISO item.characteristics.damage.max}}
				</span>
			{{/if}} 
			<span class="life" {{militaryTooltip item.characteristics 'life'}}>
				{{formatNumberWithISO item.characteristics.life}}
			</span>
		</div>
	{{/if}}
</template>

<template name="item_price">
	<ul class="resources">
		{{#each (getResources price)}}
			{{#if eq this.engName 'time'}}
				<li class="time" {{priceTooltip price 'time'}}>
					Время строительства: 
					<time>{{formatSeconds this.amount}}</time>
				</li>
			{{else}}
				<li class="{{this.engName}} {{#if (isArtefact this.engName)}}artefact{{/if}}" {{priceTooltip price this.engName}}>
					{{formatNumberWithISO this.amount}}
				</li>
			{{/if}}
		{{/each}}
	</ul>
</template>

<template name="tooltipTable">
	<table>
		{{#each values}}
			<tr class="{{#if this.total}}total{{/if}} {{#if this.negative}}negative{{/if}}">
				{{#if or this.initial this.total}}
					<td colspan="4">
						{{#if this.initial}}
							Начальное значение: {{this.initial}}
						{{else}}
							Итог: {{this.total}}
						{{/if}}
					</td>
				{{else}}
					<td>{{this.sign}}</td>
					<td>{{this.value}}</td>
					{{#if this.percent}}
						<td>{{this.percent}}%</td>
					{{/if}}
					<td colspan="{{#if not this.percent}}2{{else}}1{{/if}}">{{this.source}}</td>
				{{/if}}
			</tr>
		{{/each}}
	</table>
</template>