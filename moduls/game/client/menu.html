<template name="top_menu">
	<ul class="top_menu">
		<li><a href="{{pathFor 'chat' room='general'}}">Чат</a></li>
		<li><a href="{{pathFor 'statistics'}}">Статистика</a></li>
		<!--<li><a href="">Настройки</a></li>-->
		<li><a href="javascript: ShowModalWindow(Template.support)">Служба поддержки</a></li>
		<li><a href="http://ru.consulwar.wikia.com" target="_blank">Неофициальная вики</a></li>
		<li><a href="{{pathFor 'logout'}}">Выход</a></li>
	</ul>
</template>

<template name="game_menu">
	<ul class="game_menu">
		{{#each menu}}
			<li class="{{this.engName}}-icon{{#if this.isActive}} active{{/if}} {{this.additionalClass}}">
				<a href="{{this.url}}"></a>
			</li>
		{{/each}}
	</ul>
</template>

<template name="side_menu">
	<ul class="side_menu">
		{{#each sides}}
			<li class="{{this.engName}}-icon{{#if this.isActive}} active{{/if}}{{#if this.progress}} progress{{/if}}">
				<a href="{{this.url}}">{{this.name}}</a>
			</li>
		{{/each}}
		{{#if eq sides.length 2}}
			<!--<li class="helpusplease">
				<a href="https://boomstarter.ru/projects/zav/consul_war">Поддержите</a> нас:<br/>
				1. <a href="http://vk.com/zelenin39?w=wall1466715_672" target="_blank">Репост ВК</a><br/>
				2. <a href="http://vk.com/consulwar" target="_blank">Группа ВК</a><br/>
				3. <a href="https://twitter.com/ZAV39/status/629592939400982528" target="_blank">Ретвит</a><br/>
				4. <a href="mailto: consulwar@gmail.com">Ошибки и предложения</a><br/>
				5. <a href="http://ru.consulwar.wikia.com" target="_blank">Наполните вики</a>
			</li>-->
		{{/if}}
	</ul>
</template>

<template name="additional_area">
	{{#if sideHero}}
		<div 
			class="
				additional_area 
				quest
				{{sideHero}} 
				{{#if gt status -1}}
					{{#if eq status 0}}prompt{{/if}}
					{{#if eq status 3}}finished{{/if}}
				{{/if}}"
		>
			{{#if quests}}
				{{#if isOpened}}
					<ul class="quests">
						{{#each quests}}
							<li 
								data-id="{{this.engName}}"
								class="
									{{#if eq this.status 0}}prompt{{/if}}
									{{#if eq this.status 1}}inprogress{{/if}}
									{{#if eq this.status 3}}finished{{/if}}"
							>
								{{this.name}}
							</li>
						{{/each}}
					</ul>
				{{/if}}
				<a class="quests-switch {{#if isOpened}}close{{else}}open{{/if}}"></a>
			{{/if}}
		</div>
	{{/if}}
</template>

<template name="items_menu">
	<ul class="bottom_menu items">
		{{#each items}}
			{{#let progress=this.progress}}
				<li 
					class="{{#if isPartOfUrl currentUrl this.url}}active{{/if}}{{#if progress}} progress{{/if}}{{#unless this.meetRequirements}} disabled{{/unless}}{{#if this.isEnoughResources}} enough_resources{{/if}} {{this.type}}" 
					data-level="{{#if this.currentLevel}}{{formatNumberWithISO this.currentLevel 3}}{{/if}}" >
					<a 
						class="{{this.engName}}-icon" 
						href="{{this.url}}"
						data-remaining="{{#if progress}}{{formatSeconds (substract progress.finishTime serverTime)}}{{/if}}"></a>
				</li>
			{{/let}}
		{{/each}}
	</ul>
</template>

<template name="overlay_menu">
	<div class="overlay {{menuGroup}} {{itemGroup}}">
		{{#each items}}
			{{#if gt this.currentLevel 0}}
				<a href="{{this.url}}" class="{{this.engName}}-icon" title="{{this.name}}"></a>
			{{/if}}
			
			{{#let progress=this.progress}}
				{{#if progress}}
					<a class="{{progress.engName}}-icon" title="{{progress.name}}" progress="{{percentRound10 progress}}"></a>
				{{/if}}
			{{/let}}
		{{/each}}
		
		{{#if eq currentUrl (pathFor route='building' group='residential')}}
			<progress class="metals {{#with multiply income.metals 0.25}}{{#if gt resources.metals.bonus this}}active{{/if}}{{/with}}" max="{{multiply income.metals bonusStorage}}" value="{{or resources.metals.bonus '0'}}"></progress>
			<progress class="crystals {{#with multiply income.crystals 0.25}}{{#if gt resources.crystals.bonus this}}active{{/if}}{{/with}}" max="{{multiply income.crystals bonusStorage}}" value="{{or resources.crystals.bonus '0'}}"></progress>
		{{/if}}
	</div>
</template>