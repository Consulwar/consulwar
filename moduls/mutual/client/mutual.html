<template name="item_mutual">
	<div class="information {{mutual.type}}">
		<div class="image">
			<img alt="{{mutual.name}}" src="/img/game/mutual/{{mutual.group}}/{{mutual.engName}}.jpg">
			<span class="title">{{mutual.name}}</span>
			{{#if mutual.currentLevel}}
				<span class="level" title="{{formatNumber mutual.currentLevel}}">{{formatNumberWithISO mutual.currentLevel}} уровень</span>
			{{/if}}
		</div>
		<div class="description">
			{{> item_requirements requirements=mutual.requirements}}

			<p>{{mutual.description}}</p>
			
			{{> item_effect item=mutual}}
		</div>

		<ul class="resources">
			{{#let price=(mutual.price count)}}
				{{#if price.humans}}
					<li class="humans" {{priceTooltip price 'humans'}}>
						{{formatNumberWithISO price.humans}}
					</li>
				{{/if}}
				{{#if price.honor}}
					<li class="honor" {{priceTooltip price 'honor'}}>
						{{formatNumberWithISO price.honor}}
					</li>
				{{/if}}
				{{#if price.metals}}
					<li class="metals" {{priceTooltip price 'metals'}}>
						{{formatNumberWithISO price.metals}}
					</li>
				{{/if}}
				{{#if price.crystals}}
					<li class="crystals" {{priceTooltip price 'crystals'}}>
						{{formatNumberWithISO price.crystals}}
					</li>
				{{/if}}
				<li class="button">
					<button 
						class="build"
						data-action="invest"
						data-currency="resources" disabled="{{not (mutual.canBuild count 'resources')}}"
					>
						Вложить ресурсы
					</button>
				</li>
				
				{{#if price.credits}}
					<li></li>
					<li class="credits" {{priceTooltip price 'credits'}}>
						{{formatNumberWithISO price.credits}}
					</li>
					<li class="button">
						или
						<button 
							class="build" 
							data-action="invest" 
							data-currency="credits" 
							disabled="{{not (mutual.canBuild count 'credits')}}"
						>
							Вложить кредиты
						</button>
					</li>
				{{/if}}
			{{/let}}
		</ul>

		<progress max="{{mutual.investments}}" value="{{mutual.currentInvestments}}"></progress>

		<input class="count" type="number" placeholder="Количество" value="{{count}}"/>
		
		{{> top_investors}}

		{{> Template.dynamic template=additionalArea}}
	</div>
</template>

<template name="top_investors">
	<div class="additional_area">
		<ol>
		{{#each investors}}
			<li>
				{{this.login}} — {{this.investments}} вложений<br/>
				{{#if this.resources.metals}}<span class="metals">{{this.resources.metals}} металла</span>{{/if}} 
				{{#if this.resources.crystals}}<span class="crystals">{{this.resources.crystals}} кристалла</span>{{/if}} 
				{{#if this.resources.credits}}<span class="credits">{{this.resources.credits}} кредитов</span>{{/if}}
			</li>
		{{/each}}
		</ol>
	</div>
</template>