<template name="payment">
  <div class="payment scrollbar-inner">
    <span>
      <span class="alert">Помните, Консулы:</span> 
      покупая 
      <span class="ggk">Грязные Галактические Кредиты,</span> 
      вы поддерживаете 
      <span class="alert">Борьбу за освобождение Земли от Рептилоидов.</span>
    </span>
    <div class="paymentItems">
      {{#each paymentItems}}
        <div class="{{this.id}}-icon">
          <div class="description">
            Кредиты: <span>{{formatNumber this.result.base}}</span>
            {{#if this.result.bonus}}
              + 
              <span>{{formatNumber this.result.bonus}}</span>
            {{/if}}
            {{#if this.result.extra}}
              + 
              <span>{{formatNumber this.result.extra}}</span>
            {{/if}}
          </div>
          <div class="profit">
            {{formatNumber this.profit.resources.credits}}
            {{#if this.result.extra}}
              <span class="previous">
                {{formatNumber (sum this.result.base (or this.result.bonus 0))}}
              </span>
            {{/if}}
          </div>
          <div class="price">
            {{formatNumber this.cost.rub}}
          </div>
          
          <button class="greenButton" data-id="{{this.id}}">
            Приобрести
          </button>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="paymentPlatbox">
  <div class="payment platbox">
    <iframe src="{{url}}"></iframe>
  </div>
</template>

<template name="paymentTeko">
  <div class="payment teko">
    <iframe src="{{url}}"></iframe>
  </div>
</template>

<template name="paymentReward">
  <div class="payment reward">
    <img src="/img/game/quests/credits.png">
    <div class="count">{{formatNumber item.profit.resources.credits}}</div>
    <div class="description">{{item.description}}</div>
    <div class="take">Забрать</div>
  </div>
</template>

<template name="paymentSide">
  <div class="side_payment">
    <h2>Грязные галактические кредиты</h2>
    <div class="buy">
      Покупая <span class="yellow">Кредиты,</span> ты поддерживаешь независимого <span class="blue">российского разработчика.</span>
    </div>
    <a href="{{pathFor 'walletHistory' type='income' page=1}}">История покупок</a>
    <a href="{{pathFor 'walletHistory' type='expense' page=1}}">История расходов</a>
  </div>
</template>

<template name="paymentHistory">
  <div class="paymentHistory">
    <a class="btn-close" href="{{pathFor 'house' group='house'}}"></a>

    {{#if isIncome}}

      <table>
        <tr class="header">
          <th>Время</th>
          <th>Получено</th>
          <th></th>
        </tr>
      </table>
      <div class="data">
        <table>
          {{#each history}}
            <tr>
              <td>{{formatDate this.timestamp}}</td>
              <td>{{formatProfit this.profit}}</td>
              <td>
                {{#if eq this.source.type 'payment'}}
                  Покупка: {{this.source.item}}
                {{/if}}
                {{#if eq this.source.type 'promo'}}
                  Промокод: {{this.source.code}}
                {{/if}}
              </td>
            </tr>
          {{/each}}
        </table>
      </div>

    {{else}}

      <table>
        <tr class="header">
          <th>Время</th>
          <th>Потрачено кредитов</th>
          <th></th>
        </tr>
      </table>
      <div class="data">
        <table>
          {{#each history}}
            <tr>
              <td>{{formatDate this.timeUpdated}}</td>
              <td>{{formatNumber this.credits}}</td>
              <td>
                {{#if eq this.type 'chatFree'}}
                  Не платить за ссаный чат
                {{/if}}
                {{#if eq this.type 'chatBalance'}}
                  Пополнение баланса комнаты в чате
                {{/if}}
                {{#if eq this.type 'chatIcon'}}
                  Покупка иконки для чата
                {{/if}}
                {{#if eq this.type 'planetRename'}}
                  Переименование планеты
                {{/if}}
                {{#if eq this.type 'planetBuy'}}
                  Покупка дополнительной колонии
                {{/if}}
                {{#if eq this.type 'card'}}
                  Покупка карточки
                {{/if}}
                {{#if eq this.type 'unitBuild'}}
                  Покупка юнитов
                {{/if}}
                {{#if eq this.type 'mutualInvest'}}
                  Вложение в общие исследования
                {{/if}}
                {{#if eq this.type 'building'}}
                  Постройка здания
                {{/if}}
                {{#if eq this.type 'researchStart'}}
                  Покупка исследования
                {{/if}}
                {{#if eq this.type 'houseItem'}}
                  Покупка предмета в палате
                {{/if}}
                {{#if eq this.type 'container'}}
                  Покупка контейнера
                {{/if}}
                {{#if eq this.type 'sepukku'}}
                  Сэппуку
                {{/if}}
                {{#if eq this.type 'personSkin'}}
                  Покупка скина персонажа
                {{/if}}

                {{#if gt this.items.length 1}}
                  ({{this.items.length}})
                {{/if}}
              </td>
            </tr>
          {{/each}}
        </table>
      </div>

    {{/if}}

    {{> pages total=countTotal perPage=count}}

    {{#if isLoading}}
      {{> loading}}
    {{/if}}
  </div>
</template>
